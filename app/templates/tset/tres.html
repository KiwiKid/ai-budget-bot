{% extends "/shared/_base.html" %} {% block content %}

<div id="mainContent">
  <div
    class="fixed top-1 right-10 z-10 max-w-xs bg-gray-300 p-6 text-lg border-solid border-2 border-sky-500"
  >
    {% if page > 0 %}
    <a
      href="/tset/{{ ts_id }}?page={{ page - 1 }}&limit={{ limit }}"
      class="block text-blue-600 hover:underline mb-2"
    >
      &lt; &lt; &lt; &lt; Previous Page
    </a>
    {% endif %}
    <h3 class="text-xl font-bold">Page: {{page + 1}} Limit: {{limit}}</h3>
    <div>
      {% if not last_page %}
      <a
        href="/tset/{{ ts_id }}?page={{ page + 1 }}&limit={{ limit }}"
        class="block text-blue-600 hover:underline"
      >
        Next Page &gt; &gt; &gt; &gt;
      </a>
      {% endif %} {% if done %}
      <div class="mt-4 text-lg font-semibold">ALL COMPLETE</div>
      {% endif %}
    </div>

    <div>
      <a href="/tset/{{ts_id}}/upload" class="text-blue-600 hover:underline"
        >re-upload</a
      >
    </div>

    <div class="mb-4">
      <a href="/" class="text-blue-600 hover:underline">View All Batches</a>
    </div>

    <details>
      <summary>Config</summary>
      <div class="flex flex-col h-96 overflow-y-auto p-4 pb-16">
        <div hx-get="/api/tset/{{ts_id}}/headers" hx-trigger="load">
          <div hx-swap="outerHTML" hx-target="#form-container"></div>

          <div id="form-container">
            <!-- The form content will be injected here -->
          </div>
        </div>
      </div>
    </details>
  </div>
  <div>
    <!--<div style="height: 300px" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=1"></div>
  <div style="height: 300px" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=2"></div>-->
    <!-- Main Content -->
    <div class="flex-grow px-8 py-6">
      <!-- Add your charts here when ready
    <div class="mb-6" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=1"></div>
    <div class="mb-6" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=2"></div>
    -->

      <!-- Table -->
      <table class="min-w-full border border-gray-300 rounded-md">
        <thead>
          <tr>
            <th class="px-4 py-2 border-b">Date</th>
            <th class="px-4 py-2 border-b">Description</th>
            <th class="px-4 py-2 border-b">Amount</th>
            <th class="px-4 py-2 border-b">Category</th>
          </tr>
        </thead>
        <tbody>
          {% for transaction in transactions %}
          <tr class="hover:bg-gray-100">
            <td class="px-4 py-2 border-b">{{ transaction[3] }}</td>
            <td class="px-4 py-2 border-b">{{ transaction[4] }}</td>
            <td class="px-4 py-2 border-b">{{ transaction[5] }}</td>
            <td class="px-4 py-2 border-b flex items-center">
              {% if transaction[7] %} {{ transaction[7] }}
              <button
                hx-delete="/tset/{{ts_id}}/t_id/{{transaction[0]}}/category"
                hx-swap="none"
                class="ml-4 bg-yellow-500 text-white py-1 px-3 rounded hover:bg-yellow-600 focus:outline-none"
              >
                Reset Category
              </button>
              {% else %}
              <button
                hx-post="/tset/{{ts_id}}/categorize"
                hx-swap="innerHTML"
                hx-target="#mainContent"
                class="bg-blue-600 text-white py-1 px-3 rounded hover:bg-blue-700 focus:outline-none"
              >
                CATEGORIZE MORE!
              </button>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  {{ response }} {% endblock %}
</div>
