{% extends "/shared/_base.html" %} {% block content %}
<div id="mainContent">
  <div>
    grand_total: ${{grand_total}}
    
  </div>
  <div>
    <ul>
    {% for stat in stats %}
    <li>
      {{stat.count}} rows are
      {{stat.status}}
      (${{stat.total}})
    </li>
    {% endfor %}
  </ul>
    
  </div>
  <div class="flex justify-between items-center mt-4">
    {% if prev_page|length > 0 %}
    <a
        href="{{prev_page}}"
        class="text-blue-200 underline"
    >
        &lt; &lt; &lt; &lt; Previous Page
    </a>
    {% endif %}

    <div>
        {% if done %}
        <div class="text-lg font-semibold">ALL COMPLETE</div>
        {% endif %} 
        <div class="text-lg font-bold">Page: {{page + 1 }} Limit: {{limit}}
          <a href="/tset/{{ts_id}}/upload" class="text-blue-600 hover:underline"
            >(add new)</a
          ></div>
          <div>
            [{{ page * limit }} - {{ (page +1) * limit}}]
          </div>
    </div>


    {% if next_page|length > 0 %}
    <a
        href="{{next_page}}"
        class="text-blue-200 underline"
    >
        Next Page &gt; &gt; &gt; &gt;
    </a>
    {% endif %}
</div>

    <div class="flex-grow px-8 py-6">
      <!-- Add your charts here when ready
    <div class="mb-6" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=1"></div>
    <div class="mb-6" hx-ext="echarts" hx-trigger="load" hx-get="/tset/{{ ts_id }}/chart?mode=2"></div>
    -->

      <table class="min-w-full border border-gray-300 rounded-md">
        <thead>
          <tr>
            <th class="px-4 py-2 border-b text-left">Date</th>
            <th class="px-4 py-2 border-b text-left">Description</th>
            <th class="px-4 py-2 border-b text-left">Amount</th>
            <th class="px-4 py-2 border-b text-left">Category</th>
          </tr>
        </thead>
        <tbody>
          {% for transaction in transactions %}
          <tr class="hover:bg-gray-700">
            <td class="px-4 py-2 border-b text-left">{{ transaction.date }}</td>
            <td class="px-4 py-2 border-b text-left">{{ transaction.description }}</td>
            <td class="px-4 py-2 border-b text-left">{{ transaction.amount }}</td>
            <td class="px-4 py-2 border-b text-left">
                {% if transaction.category %} <div>{{ transaction.category }}
                <button
                  hx-delete="/tset/{{transaction.ts_id}}/t_id/{{transaction.t_id}}/category"
                  hx-swap="none"
                  class="ml-4 bg-yellow-500 text-white py-1 px-1 text-sm rounded hover:bg-yellow-600 focus:outline-none"
                >
                  Reset Category
                </button>
              </div>
              {% else %}
              <div>
                <button
                  hx-post="/tset/{{ts_id}}/categorize"
                  hx-swap="outerHTML"
                  hx-target="#mainContent"
                  class="bg-blue-600 text-white py-1 px-3 rounded hover:bg-blue-700 focus:outline-none"
                >
                  CATEGORIZE!
                </button>
            </div>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="flex justify-between items-center mt-4">
        {% if page > 0 %}
        <a
            href="/tset/{{ ts_id }}?page={{ page - 1 }}&limit={{ limit }}"
            class="text-blue-200 underline"
        >
            &lt; &lt; &lt; &lt; Previous Page
        </a>
        {% else %}
        <div></div>
        {% endif %}
    
        <div>
            {% if done %}
            <div class="text-lg font-semibold">ALL COMPLETE</div>
            {% endif %}
            <h3 class="text-lg font-bold">Page: {{page + 1}} Limit: {{limit}} {{total}}</h3>
        </div>
    
        {% if not last_page %}
        <a
            href="/tset/{{ ts_id }}?page={{ page + 1 }}&limit={{ limit }}"
            class="text-blue-200 underline"
        >
            Next Page &gt; &gt; &gt; &gt;
        </a>
        {% else %}
        <div></div>
        {% endif %}
    </div>
    </div>
  </div>

  {{ response }} {% endblock %}
</div>
</div>